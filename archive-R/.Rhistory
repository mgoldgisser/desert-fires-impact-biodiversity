animals <- read_csv("~/GitHub/desert-fires-impact-biodiversity/data/csv-for-r/animals_v2.csv")
library(tidyverse)
road_dens <- read_csv("~/GitHub/desert-fires-impact-biodiversity/data/road_density_perkm2.csv")
areas <- read.csv('~/GitHub/desert-fires-impact-biodiversity/data/areas.csv')
ggplot(road_dens, aes(treatmentGroup, mean, color = desert)) +
geom_pointrange(aes(ymin = mean-sd, ymax = mean+sd, color = desert), size = 1, shape = 16, position = position_dodge(width = .4)) +
geom_point(aes(y = median, shape = desert), size = 3, color = "black", position = position_dodge(width = 0.4)) +
scale_shape_manual(values = c(4, 4, 4)) +
guides(shape = "none") +
ylab(bquote(" Mean road density \n(amount of road per "~km^2~")")) +
xlab("") +
scale_x_discrete(labels = c("Burned", "Control")) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
theme(legend.title=element_blank(),
legend.position="top")
animals <- read_csv("~/GitHub/desert-fires-impact-biodiversity/data/csv-for-r/animals_v2.csv")
animals <- animals %>%
rename(fireArea_km2 = area_km2) %>%
#left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(mean_nearRdDist = mean(nearRdDist),
mean_nearUADist = mean(nearUADist),
area_km2 = round(mean(area_km2)),
totalOccReported =n(),
totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM2_ORreported = 2*sd_avgORper1000km2/sqrt(n()))
road_dens <- left_join(road_dens, animals, by = c("desert", "treatmentGroup"))
shapiro.test(road_dens$mean)
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
theme(legend.title=element_blank(),
legend.position="top")
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 25, y = 300, label = lm_eqn(df), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
lm_eqn <- function(df){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 25, y = 300, label = lm_eqn(df), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 25, y = 300, label = lm_eqn(road_dens), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
as.character(as.expression(eq));
lm_eqn <- function(df){
m <- lm(yrlyAvgORPer1000km2 ~ mean, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 25, y = 300, label = lm_eqn(road_dens), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean occurrences reported annually per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 20, y = 7, label = lm_eqn(road_dens), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean annual occurrences reported per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#1b9e77", "#d95f02", "#7570b3")) +
theme_bw() +
geom_text(x = 20, y = 7, label = lm_eqn(road_dens), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
ggplot(road_dens, aes(mean, yrlyAvgORPer1000km2)) +
geom_smooth(method= "lm", color = "black", se = FALSE) +
geom_point(aes(shape = ez_taxa, color = desert), size = 3) +
#facet_grid(vars(ez_taxa), scales = "free_y") +
ylab(bquote("Mean annual occurrences reported per 1,000 "~km^2)) +
xlab(bquote(" Mean road density (amount of road per "~km^2~")")) +
scale_y_continuous(limits = c(0, 21)) +
scale_color_manual(values = c("#d95f02", "#7570b3", "#1b9e77")) +
theme_bw() +
geom_text(x = 20, y = 7, label = lm_eqn(road_dens), parse = TRUE) +
theme(legend.title=element_blank(),
legend.position="top")
mod <- lm(yrlyAvgORPer1000km2 ~ mean, data = road_dens)
summary(mod)
