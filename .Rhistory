panel.grid.major.y = element_line(color = 'black') +
facet_wrap(vars(ez_taxa)) +
coord_flip()
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
data %>%
group_by(obsYear, treatmentGroup, desert, ez_taxa) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs)) %>%
ggplot(aes(x = desert, y = total_standard_obs, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("")+
scale_color_aaas(labels=c("Control","Burned area"), name = "Burn Treatment") +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank()
panel.grid.major.y = element_line(color = 'black')) +
data %>%
group_by(obsYear, treatmentGroup, desert, ez_taxa) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs)) %>%
ggplot(aes(x = desert, y = total_standard_obs, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("")+
scale_color_aaas(labels=c("Control","Burned area"), name = "Burn Treatment") +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = 'black')) +
facet_wrap(vars(ez_taxa)) +
coord_flip()
data %>%
group_by(obsYear, treatmentGroup, desert, ez_taxa) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs)) %>%
ggplot(aes(x = desert, y = total_standard_obs, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("")+
scale_color_aaas(labels=c("Control","Burned area"), name = "Burn Treatment") +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = 'black')) +
facet_wrap(vars(ez_taxa)) +
coord_flip()
data %>%
group_by(obsYear, treatmentGroup, desert, ez_taxa) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs)) %>%
ggplot(aes(x = desert, y = total_standard_obs, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("")+
scale_color_aaas(labels=c("Control","Burned area"), name = "Burn Treatment") +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = 'grey')) +
facet_wrap(vars(ez_taxa)) +
coord_flip()
ggplot(data, aes(x = obsYear, y = stzd_totalObs, color = treatmentGroup)) +
geom_point(size = 2) +
geom_smooth(method = "gam", aes(fill = treatmentGroup)) +
ylim(0, 70) +
xlim(2000, 2020) +
facet_grid(vars(desert)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("Year") +
scale_color_uchicago(name = "Burn Treatment",
labels = c("Burned", "Control")) +
scale_fill_manual(values = c("#800000ff", "#767676FF"),
name = "Burn Treatment",
labels = c("Burned", "Control")) +
theme_bw()
unique(list$order)
animals <- st_read("shapefiles/animals/animals_51022.shp") %>%
st_drop_geometry() %>%
rename(obsID = TARGET_FID, order = order_, individualCount = individual, obsDay = day, obsMonth = month, obsYear = year, institutionalCode = institutio, treatmentGroup = treatmentG, fireName = INCIDENT, fireYear = FIRE_YEARn, fireSize = GISAcres) %>%
select(-c("verbatimSc", "issue", "coordinate", 'nearRd_FID', "nearUA_FID")) %>%
filter(obsYear > 1999, obsYear < 2021, species != "Canis lupus", species != "Balaenoptera musculus", species != "Grus canadensis", treatmentGroup != "burned prior 2000") %>%
mutate(simplified_taxa =
ifelse(genus == "Puma" | genus == "Ovis", "Large Mammals",
ifelse(genus == "Branchinecta" | genus == "Cyprinodon", "Aquatic",
ifelse(genus == "Dinacoma", "Beetles",
ifelse(genus == "Bombus", "Bees",
ifelse(genus == "Gopherus", "Tortoises",
ifelse(genus == "Danaus" | genus == "Euproserpinus", "Butterflies & Moths",
ifelse(genus == "Rana" | genus == "Anaxyrus","Frogs and Toads",
ifelse(genus == "Ambystoma" | genus == "Batrachoseps", "Salamanders",
ifelse(genus == "Coleonyx" | genus == "Gambelia" | genus == "Uma", "Lizards & Geckos",
ifelse(genus %in% sm_mam, "Small Mammals",
ifelse(order %in% raptors, "Birds:Raptors",
ifelse(order == "Passeriformes", "Birds:Passerines",
ifelse(order == "Piciformes", "Birds:Woodpeckers",
ifelse(order == "Gruiformes" | order == "Anseriformes", "Birds:Rails and Geese", "ERROR"
)))))))))))))))
ndvi_burned <- read_csv("data/mean_ndvi_burned.csv") %>%
mutate(treatmentGroup = "burned")
ndvi_nb <- read_csv("data/mean_ndvi_never_burned.csv") %>%
mutate(treatmentGroup = "never burned")
ndvi <- rbind(ndvi_burned, ndvi_nb) %>%
rename(obsYear = year)
sites <- read_csv("data/sitesv2-2022.csv") %>%
select(-desert)
sites_sf <- st_read("shapefiles/fires/fires2000.shp")
fireid <- unique(sites$fireID)
sites_sf <- sites_sf %>% filter(fireID %in% fireid)
sites_sf$confirmarea <- st_geod_area(sites_sf)
#just the fires for occurrences
fireid <- unique(animals$fireID)[-1]
animals <- st_read("shapefiles/animals/animals_51022.shp") %>%
st_drop_geometry() %>%
rename(obsID = TARGET_FID, order = order_, individualCount = individual, obsDay = day, obsMonth = month, obsYear = year, institutionalCode = institutio, treatmentGroup = treatmentG, fireName = INCIDENT, fireYear = FIRE_YEARn, fireSize = GISAcres) %>%
select(-c("verbatimSc", "issue", "coordinate", 'nearRd_FID', "nearUA_FID")) %>%
filter(obsYear > 1999, obsYear < 2021, species != "Canis lupus", species != "Balaenoptera musculus", species != "Grus canadensis", treatmentGroup != "burned prior 2000") %>%
mutate(simplified_taxa =
ifelse(genus == "Puma" | genus == "Ovis", "Large Mammals",
ifelse(genus == "Branchinecta" | genus == "Cyprinodon", "Aquatic",
ifelse(genus == "Dinacoma", "Beetles",
ifelse(genus == "Bombus", "Bees",
ifelse(genus == "Gopherus", "Tortoises",
ifelse(genus == "Danaus" | genus == "Euproserpinus", "Butterflies & Moths",
ifelse(genus == "Rana" | genus == "Anaxyrus","Frogs and Toads",
ifelse(genus == "Ambystoma" | genus == "Batrachoseps", "Salamanders",
ifelse(genus == "Coleonyx" | genus == "Gambelia" | genus == "Uma", "Lizards & Geckos",
ifelse(genus %in% sm_mam, "Small Mammals",
ifelse(order %in% raptors, "Birds:Raptors",
ifelse(order == "Passeriformes", "Birds:Passerines",
ifelse(order == "Piciformes", "Birds:Woodpeckers",
ifelse(order == "Gruiformes" | order == "Anseriformes", "Birds:Rails and Geese", "ERROR"
)))))))))))))))
sm_mam <- c("Ammospermophilus", "Xerospermophilus", "Dipodomys", "Vulpes")
raptors  <- c("Accipitriformes", 'Pelecaniformes', "Strigiformes", "Falconiformes")
animals <- st_read("shapefiles/animals/animals_51022.shp") %>%
st_drop_geometry() %>%
rename(obsID = TARGET_FID, order = order_, individualCount = individual, obsDay = day, obsMonth = month, obsYear = year, institutionalCode = institutio, treatmentGroup = treatmentG, fireName = INCIDENT, fireYear = FIRE_YEARn, fireSize = GISAcres) %>%
select(-c("verbatimSc", "issue", "coordinate", 'nearRd_FID', "nearUA_FID")) %>%
filter(obsYear > 1999, obsYear < 2021, species != "Canis lupus", species != "Balaenoptera musculus", species != "Grus canadensis", treatmentGroup != "burned prior 2000") %>%
mutate(simplified_taxa =
ifelse(genus == "Puma" | genus == "Ovis", "Large Mammals",
ifelse(genus == "Branchinecta" | genus == "Cyprinodon", "Aquatic",
ifelse(genus == "Dinacoma", "Beetles",
ifelse(genus == "Bombus", "Bees",
ifelse(genus == "Gopherus", "Tortoises",
ifelse(genus == "Danaus" | genus == "Euproserpinus", "Butterflies & Moths",
ifelse(genus == "Rana" | genus == "Anaxyrus","Frogs and Toads",
ifelse(genus == "Ambystoma" | genus == "Batrachoseps", "Salamanders",
ifelse(genus == "Coleonyx" | genus == "Gambelia" | genus == "Uma", "Lizards & Geckos",
ifelse(genus %in% sm_mam, "Small Mammals",
ifelse(order %in% raptors, "Birds:Raptors",
ifelse(order == "Passeriformes", "Birds:Passerines",
ifelse(order == "Piciformes", "Birds:Woodpeckers",
ifelse(order == "Gruiformes" | order == "Anseriformes", "Birds:Rails and Geese", "ERROR"
)))))))))))))))
ndvi_burned <- read_csv("data/mean_ndvi_burned.csv") %>%
mutate(treatmentGroup = "burned")
ndvi_nb <- read_csv("data/mean_ndvi_never_burned.csv") %>%
mutate(treatmentGroup = "never burned")
ndvi <- rbind(ndvi_burned, ndvi_nb) %>%
rename(obsYear = year)
sites <- read_csv("data/sitesv2-2022.csv") %>%
select(-desert)
sites_sf <- st_read("shapefiles/fires/fires2000.shp")
fireid <- unique(sites$fireID)
sites_sf <- sites_sf %>% filter(fireID %in% fireid)
sites_sf$confirmarea <- st_geod_area(sites_sf)
#just the fires for occurrences
fireid <- unique(animals$fireID)[-1]
sites$fireID <- as.factor(sites$fireID)
sites_sf$fireID <- as.factor(sites_sf$fireID)
sites_sf <- as.data.frame(sites_sf) %>% filter(fireID %in% fireid) %>%
left_join(sites, by = "fireID") %>%
select(c(desert, INCIDENT, FIRE_YEARn, fireID, area_km2, startDate))
fire_area <- st_read("~/GitHub/desert-fires-impact-biodiversity/shapefiles/fires/fires2000.shp") %>% #polygons for never-burned desert sites
st_transform(crs = 4326) %>% #transform data to wgs84 to match raster
filter(fireID %in% fireid)
fire_area_sj <- fire_area %>%
filter(desert == "San Joaquin")
fire_area_moj <- fire_area %>%
filter(desert == "Mojave")
fire_area_son <- fire_area %>%
filter(desert == "Sonoran")
desert <- c("San Joaquin", "Mojave", "Sonoran")
area_km2 <- c(as.numeric(sum(fire_area_sj$area_km2)),
as.numeric(sum(fire_area_moj$area_km2)),
as.numeric(sum(fire_area_son$area_km2)))
areas <- data.frame(desert, area_km2) %>%
mutate(treatmentGroup = "burned")
head(areas)
nb_area <- st_read("~/GitHub/desert-fires-impact-biodiversity/shapefiles/deserts/minus-fires/deserts-minus-fires.shp") %>% #polygons for never-burned desert sites
st_transform(crs = 4326) #transform data to wgs84 to match raster
nb_area_sj <- nb_area %>%
filter(desert == "San Joaquin")
nb_area_moj <- nb_area %>%
filter(desert == "Mojave")
nb_area_son <- nb_area %>%
filter(desert == "Sonoran")
nb_area_moj$area_km2 <- st_geod_area(nb_area_moj) / 1000000
as.numeric(sum(nb_area_moj$area_km2))
nb_area_sj$area_km2 <- st_geod_area(nb_area_sj) / 1000000
as.numeric(sum(nb_area_sj$area_km2))
nb_area_son$area_km2 <- st_geod_area(nb_area_son) / 1000000
as.numeric(sum(nb_area_son$area_km2))
area_km2 <- c(as.numeric(sum(nb_area_sj$area_km2)),
as.numeric(sum(nb_area_moj$area_km2)),
as.numeric(sum(nb_area_son$area_km2)))
areas_nb <- data.frame(desert, area_km2) %>%
mutate(treatmentGroup = "never burned")
areas <- rbind(areas, areas_nb)
View(areas)
View(animals)
animals <- animals %>% select(-c('basisOfRec', 'institutionalCode', 'collection', 'recordedBy', 'nearRdDist', 'nearUADist')) %>%
mutate(individualCount = ifelse(individualCount = 0, 1, individualCount))
animals <- animals %>% select(-c('basisOfRec', 'institutionalCode', 'collection', 'recordedBy', 'nearRdDist', 'nearUADist')) %>%
mutate(individualCount = ifelse(individualCount == 0, 1, individualCount))
write.csv(area, "~/GitHub/desert-fires-impact-biodiversity/data/area_v1.csv")
write.csv(sites, "~/GitHub/desert-fires-impact-biodiversity/data/sites_v1.csv")
write.csv(areas, "~/GitHub/desert-fires-impact-biodiversity/data/area_v1.csv")
write.csv(animals, "~/GitHub/desert-fires-impact-biodiversity/data/observations_v1.csv")
animals <- st_read("shapefiles/animals/animals_51022.shp") %>%
st_drop_geometry() %>%
rename(obsID = TARGET_FID, order = order_,
individualCount = individual, obsDay = day,
obsMonth = month, obsYear = year,
institutionalCode = institutio,
treatmentGroup = treatmentG, fireName = INCIDENT,
fireYear = FIRE_YEARn, fireSize = GISAcres) %>%
select(-c("verbatimSc", "issue", "coordinate", 'nearRd_FID', "nearUA_FID",
'basisOfRec', 'institutionalCode', 'collection', 'recordedBy', 'nearRdDist', 'nearUADist')) %>%
filter(obsYear > 1999, obsYear < 2021, species != "Canis lupus", species != "Balaenoptera musculus",
species != "Grus canadensis", treatmentGroup != "burned prior 2000") %>%
mutate(simplified_taxa =
ifelse(genus == "Puma" | genus == "Ovis", "Large Mammals",
ifelse(genus == "Branchinecta" | genus == "Cyprinodon", "Aquatic",
ifelse(genus == "Dinacoma", "Beetles",
ifelse(genus == "Bombus", "Bees",
ifelse(genus == "Gopherus", "Tortoises",
ifelse(genus == "Danaus" | genus == "Euproserpinus", "Butterflies & Moths",
ifelse(genus == "Rana" | genus == "Anaxyrus","Frogs and Toads",
ifelse(genus == "Ambystoma" | genus == "Batrachoseps", "Salamanders",
ifelse(genus == "Coleonyx" | genus == "Gambelia" | genus == "Uma", "Lizards & Geckos",
ifelse(genus %in% sm_mam, "Small Mammals",
ifelse(order %in% raptors, "Birds:Raptors",
ifelse(order == "Passeriformes", "Birds:Passerines",
ifelse(order == "Piciformes", "Birds:Woodpeckers",
ifelse(order == "Gruiformes" | order == "Anseriformes", "Birds:Rails and Geese", "ERROR"
)))))))))))))),
ez_taxa = ifelse(class=='Aves', 'Aves', 'Other'))
View(animals)
library(tidyverse)
library(mgcv)
library(sf)
library(lwgeom)
library(lme4)
library(ggsci)
library(ggrepel)
library(stats)
library(broom)
library(gghighlight)
library(lme4)
setwd("~/GitHub/desert-fires-impact-biodiversity")
sm_mam <- c("Ammospermophilus", "Xerospermophilus", "Dipodomys", "Vulpes")
raptors  <- c("Accipitriformes", 'Pelecaniformes', "Strigiformes", "Falconiformes")
animals <- st_read("shapefiles/animals/animals_51022.shp") %>%
st_drop_geometry() %>%
rename(obsID = TARGET_FID, order = order_,
individualCount = individual, obsDay = day,
obsMonth = month, obsYear = year,
institutionalCode = institutio,
treatmentGroup = treatmentG, fireName = INCIDENT,
fireYear = FIRE_YEARn, fireSize = GISAcres) %>%
select(-c("verbatimSc", "issue", "coordinate", 'nearRd_FID', "nearUA_FID",
'basisOfRec', 'institutionalCode', 'collection', 'recordedBy', 'nearRdDist', 'nearUADist')) %>%
filter(obsYear > 1999, obsYear < 2021, species != "Canis lupus", species != "Balaenoptera musculus",
species != "Grus canadensis", treatmentGroup != "burned prior 2000") %>%
mutate(simplified_taxa =
ifelse(genus == "Puma" | genus == "Ovis", "Large Mammals",
ifelse(genus == "Branchinecta" | genus == "Cyprinodon", "Aquatic",
ifelse(genus == "Dinacoma", "Beetles",
ifelse(genus == "Bombus", "Bees",
ifelse(genus == "Gopherus", "Tortoises",
ifelse(genus == "Danaus" | genus == "Euproserpinus", "Butterflies & Moths",
ifelse(genus == "Rana" | genus == "Anaxyrus","Frogs and Toads",
ifelse(genus == "Ambystoma" | genus == "Batrachoseps", "Salamanders",
ifelse(genus == "Coleonyx" | genus == "Gambelia" | genus == "Uma", "Lizards & Geckos",
ifelse(genus %in% sm_mam, "Small Mammals",
ifelse(order %in% raptors, "Birds:Raptors",
ifelse(order == "Passeriformes", "Birds:Passerines",
ifelse(order == "Piciformes", "Birds:Woodpeckers",
ifelse(order == "Gruiformes" | order == "Anseriformes", "Birds:Rails and Geese", "ERROR"
)))))))))))))),
ez_taxa = ifelse(class=='Aves', 'Aves', 'Other'))
ndvi_burned <- read_csv("data/mean_ndvi_burned.csv") %>%
mutate(treatmentGroup = "burned")
ndvi_nb <- read_csv("data/mean_ndvi_never_burned.csv") %>%
mutate(treatmentGroup = "never burned")
ndvi <- rbind(ndvi_burned, ndvi_nb) %>%
rename(obsYear = year)
data <- animals %>%
group_by(obsYear, treatmentGroup, desert) %>%
summarize(totalObs = n()) %>%
filter(treatmentGroup != "burned prior 2000")
sites <- read_csv("data/sitesv2-2022.csv") %>%
select(-desert)
sites_sf <- st_read("shapefiles/fires/fires2000.shp")
fireid <- unique(sites$fireID)
sites_sf <- sites_sf %>% filter(fireID %in% fireid)
sites_sf$confirmarea <- st_geod_area(sites_sf)
#view(sites_sf) #areas for area_km2 confirmed
#just the fires for occurrences
fireid <- unique(animals$fireID)[-1]
sites$fireID <- as.factor(sites$fireID)
sites_sf$fireID <- as.factor(sites_sf$fireID)
sites_sf <- as.data.frame(sites_sf) %>% filter(fireID %in% fireid) %>%
left_join(sites, by = "fireID") %>%
select(c(desert, INCIDENT, FIRE_YEARn, fireID, area_km2, startDate))
#mean annual NDVI (year in x-axis)
# ggplot(ndvi, aes(x = obsYear, y = ndvi, color = treatmentGroup, shape = desert)) +
#   geom_point(size = 3) +
#   ylim(0, 0.5) +
#   xlim(2000, 2020) +
#   facet_grid(vars(desert)) +
#   ylab("Mean NDVI") +
#   xlab("") +
#   labs(color = "Treatment Group") +
#   scale_color_uchicago(labels=c("Burned area", "Control")) +
#   scale_shape_discrete(guide = 'none') +
#   theme_bw()
#boxplot showing mean annual NDVI
ggplot(ndvi, aes(x = desert, y = ndvi, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(outlier.shape = 18)  +
ylab("Annual Mean NDVI") +
xlab("") +
scale_color_aaas(labels=c("Control", "Burned area")) +
labs(color = "Treatment Group") +
theme_classic() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12))
# number of fires and total burned area
burn_dens <- sites_sf %>% group_by(desert) %>%
summarize(total_fires = n(), total_area_burned = sum(area_km2))
ggplot(burn_dens, aes(x = desert, y = total_fires)) +
geom_col(aes(width = total_area_burned, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
#boxplot showing mean annual NDVI
ggplot(ndvi, aes(x = desert, y = ndvi, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(outlier.shape = 18)  +
ylab("Annual Mean NDVI") +
xlab("") +
scale_color_aaas(labels=c("Control", "Burned area")) +
labs(color = "Treatment Group") +
theme_classic() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12))
ggplot(burn_dens, aes(x = desert, y = total_fires)) +
geom_col(aes(width = total_area_burned, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none') +
coord_flip()
#boxplot showing mean annual NDVI
ggplot(ndvi, aes(x = desert, y = ndvi, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(outlier.shape = 18)  +
ylab("Annual Mean NDVI") +
xlab("") +
scale_color_aaas(labels=c("Control", "Burned area")) +
labs(color = "Treatment Group") +
theme_classic() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12)) +
coord_flip()
ggplot(burn_dens, aes(x = desert, y = total_fires)) +
geom_col(aes(width = total_area_burned, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
View(burn_dens)
ggplot(burn_dens, aes(x = desert, y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
ggplot(burn_dens, aes(x = reorder(desert, -total_fires) , y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
ggplot(burn_dens, aes(x = reorder(desert, -total_fires) , y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none') +
facet_grid(~desert, scales = 'free_x', space = 'free')
ggplot(burn_dens, aes(x = reorder(desert, -total_fires) , y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(aspect.ratio = 2) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
ggplot(burn_dens, aes(x = reorder(desert, -total_fires) , y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(aspect.ratio = .2) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
ggplot(burn_dens, aes(x = reorder(desert, -total_fires) , y = total_fires)) +
geom_col(aes(width = total_area_burned/721.5012, fill = desert)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
xlab("Year") +
ylab("Total number of fires") +
scale_fill_uchicago(guide = 'none')
## which class make up the occurrences
species_dist <- animals %>% group_by(class) %>%
filter(treatmentGroup != "burned prior 2000") %>%
summarize(total_rec = n()) %>%
arrange(desc(-total_rec)) %>%
mutate(percent = (total_rec/sum(total_rec)),label = (paste0(class, "\n", total_rec)))
#unique(species_dist$class)
species_dist %>%
arrange(desc(-total_rec)) %>%
mutate(class=factor(class, class)) %>%
ggplot( aes(x=class, y=total_rec) ) +
geom_segment(aes(x=class ,xend=class, y=0, yend=total_rec), color="grey", size = 2) +
geom_point(size=5, color=c("#242c47", "#242c47", "#242c47", "#242c47", "#242c47", "#242c47", "#242c47")) +
coord_flip() +
geom_text(aes(label = total_rec), nudge_x = 0.35) +
theme_classic() +
theme(panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="none",
axis.text = element_text(size = 12)) +
xlab("") +
ylab("Occurrences")
#table showing summarized values (standardized to obs per 1,000km2)
data %>% group_by(treatmentGroup, desert) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs))
data <- animals %>%
group_by(obsYear, ez_taxa, treatmentGroup, desert) %>%
summarize(totalObs = n()) %>%
filter(treatmentGroup != "burned prior 2000")
#add ndvi data
data <- left_join(data, ndvi, by = c("desert", "obsYear", "treatmentGroup"))
#add area for burned and unburned
data <- left_join(data, areas, by = c("desert", "treatmentGroup")) %>% #areas is a dataframe created from shapefiles in a hidden step
mutate(stzd_totalObs = (totalObs * 1000)/area_km2) #total observation per 10000 km2
data$desert <- as.factor(data$desert)
data$treatmentGroup <- as.factor(data$treatmentGroup)
data_og <- data
#table showing summarized values (standardized to obs per 1,000km2)
data %>% group_by(treatmentGroup, desert) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs))
data %>%
group_by(obsYear, treatmentGroup, desert, ez_taxa) %>% summarize(totalObs = sum(totalObs), mean_ndvi = mean(ndvi), area_km2 = mean(area_km2), total_standard_obs = sum(stzd_totalObs)) %>%
ggplot(aes(x = desert, y = total_standard_obs, color = fct_rev(factor(treatmentGroup)))) +
geom_boxplot(width = 0.7, position = position_dodge(0.75)) +
ylab(bquote('Total occurrences reported per 1,000 km'^2)) +
xlab("")+
scale_color_aaas(labels=c("Control","Burned area"), name = "Burn Treatment") +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = 'grey')) +
facet_wrap(vars(ez_taxa)) +
coord_flip()
View(ndvi)
View(ndvi)
write.csv(ndvi, '~GitHub/desert-fires-impact-biodiversity/data/ndv.csv')
write_csv(ndvi, '~GitHub/desert-fires-impact-biodiversity/data/ndvi.csv')
write_csv(ndvi, 'data/ndvi.csv')
areas <- read.csv('data/areas.csv')
View(areas)
View(areas)
View(ndvi)
View(ndvi)
View(ndvi)
areas <- read.csv('data/areas.csv')
ndvi <- read_csv("data/ndvi.csv")
sites <- read_csv("data/sites.csv")
