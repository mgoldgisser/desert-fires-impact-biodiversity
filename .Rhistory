left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>% ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = treatmentGroup)) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = treatmentGroup), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Burned area", "Control")) +
scale_shape_discrete(labels=c("Burned area", "Control")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
class(treatmentGroup)
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>% ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = treatmentGroup), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Burned area", "Control")) +
scale_shape_discrete(labels=c("Burned area", "Control")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
class(animals$treatmentGroup)
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>% ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Burned area", "Control")) +
scale_shape_discrete(labels=c("Burned area", "Control")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
facet_grid(vars(ez_taxa)) +
#scale_color_aaas(labels=c("Burned area", "Control")) +
#scale_shape_discrete(labels=c("Burned area", "Control")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_shape_discrete(labels=c("Control", "Burned area")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
scale_y_continuous(breaks = 3, limits = c(0, NA))+
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_shape_discrete(labels=c("Control", "Burned area")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
scale_y_continuous(breaks = 15, limits = c(0, NA))+
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_shape_discrete(labels=c("Control", "Burned area")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
scale_y_continuous(breaks = c(seq(from = 0, to = 33, by = 3)), limits = c(0, NA))+
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_shape_discrete(labels=c("Control", "Burned area")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
animals %>%
rename(fireArea_km2 = area_km2) %>%
left_join(ndvi, by = c("obsYear", "desert", "treatmentGroup")) %>%
left_join(areas, by = c('desert', "treatmentGroup")) %>%
group_by(treatmentGroup, desert, ez_taxa, obsYear) %>%
summarize(area_km2 = round(mean(area_km2)),totalOccReported =n(), totalORPer1000km2 = ceiling(sum(totalOccReported/area_km2 * 1000))) %>%
group_by(treatmentGroup, desert, ez_taxa) %>%
summarize(yrlyAvgOccReported = ceiling(mean(totalOccReported)),
yrlyAvgORPer1000km2 = ceiling(mean(totalORPer1000km2)),
sd_avgORper1000km2 = sd(totalORPer1000km2), SEM = 2*sd_avgORper1000km2/sqrt(n())) %>%
ggplot(aes(x = desert, y = yrlyAvgORPer1000km2, shape = fct_rev(as.factor(treatmentGroup)))) +
geom_pointrange(aes(ymin = yrlyAvgORPer1000km2-SEM, ymax = yrlyAvgORPer1000km2+SEM, color = fct_rev(as.factor(treatmentGroup))), position = position_dodge(width = 0.3)) +
ylab(bquote('Average Yearly Occurrences Reported per 1,000km'^2)) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 12),
axis.title.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12),
panel.grid.major.y = element_blank()) +
scale_y_continuous(breaks = c(seq(from = 0, to = 33, by = 6)), limits = c(0, NA))+
facet_grid(vars(ez_taxa)) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_shape_discrete(labels=c("Control", "Burned area")) +
labs(color = "Burn Treatment", shape = "Burn Treatment")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = desert)) +
geom_point()+
geom_smooth(se = FALSE) +
ylim(0, NA) +
facet_grid(vars(ez_taxa), cols = vars(treatmentGroup), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = desert)) +
geom_point()+
geom_smooth(se = FALSE) +
ylim(0, NA) +
facet_grid(vars(treatmentGroup), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(se = FALSE) +
ylim(0, NA) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(se = FALSE) +
ylim(0, NA) +
facet_grid(vars(desert), cols = vars(ez_taxa), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup, shape = ez_taxa)) +
geom_point()+
geom_smooth(se = FALSE) +
ylim(0, NA) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(aes(shape = ez_taxa)se = FALSE) +
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(aes(shape = ez_taxa), se = FALSE) +
ylim(0, NA) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point()+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 2)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 3)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
FALSE
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.5)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.75)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(data, aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = FALSE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa = "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", aes(linetype = ez_taxa), se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
scale_fill_aas(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa = "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
scale_linetype_discrete(labels=c("Aves", "Other")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa == "Other"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", linetype = 5, se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa == "Other"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
ggplot(filter(data, ez_taxa == "Other"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
plot1 <- ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
plot2 <- ggplot(filter(data, ez_taxa == "Other"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
plot1 <- ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
theme_bw() +
scale_color_aaas(labels=c("Control", "Burned area"), guide = FALSE) +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
plot1 <- ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
theme_bw() +
scale_color_aaas(labels=c("Control", "Burned area"), guide = FALSE) +
theme(legend.title=element_blank(),
legend.position="top") +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
plot2 <- ggplot(filter(data, ez_taxa == "Other"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
theme_bw() +
theme(legend.title=element_blank(),
legend.position="top") +
scale_color_aaas(labels=c("Control", "Burned area")) +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
plot1 <- ggplot(filter(data, ez_taxa == "Aves"), aes(x = obsYear, y = stzd_Occ, color = treatmentGroup)) +
geom_point(shape = 17, alpha = 0.65)+
geom_smooth(method = "glm", se = TRUE) +
ylim(0, NA) +
theme_bw() +
scale_color_aaas(labels=c("Control", "Burned area")) +
theme(legend.title=element_blank(),
legend.position="top") +
facet_grid(vars(desert), scales = "free")
plot_grid(plot1, plot2, labels = c("A", "B"), label_size = 12)
library(tidyverse)
library(mgcv)
library(sf)
#library(lwgeom)
library(lme4)
library(ggsci)
#library(ggrepel)
library(stats)
#library(broom)
#library(gghighlight)
library(gamm4)
#library(MuMIn)
library(cowplot)
library(MASS) #for glm.nb
library(pscl) #for zero-inflated glm
library(lmtest) #for lrtest: likelihood test of nested models
#library(VGAM) #for zero-truncated models
#library(countreg) #for zero-truncated models
library(glmmTMB) #glmm with zero-truncated nb
library(DHARMa) #diagnostic for mixed regression models
library(emmeans)
library(remote)
library(SpadeR)
setwd("~/GitHub/desert-fires-impact-biodiversity")
##code for data below
animals <- read_csv("~/GitHub/desert-fires-impact-biodiversity/data/csv-for-r/animals.csv")
data_pp <- read_csv("~/GitHub/desert-fires-impact-biodiversity/data/csv-for-r/data_pre-post.csv")
ndvi <- read_csv("data/ndvi.csv")
areas <- read.csv('data/areas.csv')
sites <- read_csv("data/sites.csv")
data <- animals %>%
filter(obsYear > 1994) %>%
group_by(obsYear, ez_taxa, simplified_taxa, treatmentGroup, desert) %>%
summarize(totalObs = sum(individualCount), totalOcc = n())%>%
#left_join(., ndvi, by = c("desert", "obsYear", "treatmentGroup")) %>% #add ndvi
left_join(., areas, by = c("desert", "treatmentGroup")) %>% #add area
mutate(stzd_totalObs = ceiling((totalObs * 1000)/area_km2), #standardize observations
stzd_Occ = ceiling((totalOcc * 1000)/area_km2),
desert = as.factor(desert),
treatmentGroup = as.factor(treatmentGroup),
#obsYear = as.factor(obsYear),
ez_taxa = as.factor(ez_taxa))
glmm1 <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = data, family = "poisson")
check_overdispersion(glmm1)
library(performance)
check_overdispersion(glmm1)
glmm1 <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = data, family = "nbinom1")
check_overdispersion(glmm1)
glmm1 <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = data, family = "nbinom2")
check_overdispersion(glmm1)
summary(glmm1)
glm1 <- glm.nb(stzd_Occ ~ obsYear + treatmentGroup + desert,
data = data)
glm1 <- glm.nb(stzd_Occ ~ obsYear + treatmentGroup + desert,
data = data)
check_overdispersion(glm1)
summary(glm1)
summary(glmm1)
glm_aves <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Aves"),
family = "poisson")
check_overdispersion(glmm_aves)
glmm_aves <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Aves"),
family = "poisson")
glmm_aves <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Aves"),
family = "poisson")
check_overdispersion(glmm_aves)
glmm_aves <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Aves"),
family = "nbinom1")
check_overdispersion(glmm_aves)
glmm_other <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Other"),
family = "poisson")
check_overdispersion(glmm_other)
glmm_other <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Other"),
family = "nbinom1")
check_overdispersion(glmm_other)
glmm_other <- glmmTMB(stzd_Occ ~ obsYear + treatmentGroup + (1|desert),
data = filter(data, ez_taxa == "Other"),
family = "poisson")
check_overdispersion(glmm_other)
